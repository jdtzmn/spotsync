webpackJsonp([1],{"+I8o":function(t,e){},"/AuU":function(t,e){},"6XzT":function(t,e){},D4uH:function(t,e,i){"use strict";var n={},o={name:"icon",props:{name:{type:String,validator:function(t){return t?t in n||(console.warn('Invalid prop: prop "name" is referring to an unregistered icon "'+t+'".\nPlesase make sure you have imported this icon before using it.'),!1):(console.warn('Invalid prop: prop "name" is required.'),!1)}},scale:[Number,String],spin:Boolean,inverse:Boolean,pulse:Boolean,flip:{validator:function(t){return"horizontal"===t||"vertical"===t}},label:String},data:function(){return{x:!1,y:!1,childrenWidth:0,childrenHeight:0,outerScale:1}},computed:{normalizedScale:function(){var t=this.scale;return t=void 0===t?1:Number(t),isNaN(t)||t<=0?(console.warn('Invalid prop: prop "scale" should be a number over 0.',this),this.outerScale):t*this.outerScale},klass:function(){return{"fa-icon":!0,"fa-spin":this.spin,"fa-flip-horizontal":"horizontal"===this.flip,"fa-flip-vertical":"vertical"===this.flip,"fa-inverse":this.inverse,"fa-pulse":this.pulse}},icon:function(){return this.name?n[this.name]:null},box:function(){return this.icon?"0 0 "+this.icon.width+" "+this.icon.height:"0 0 "+this.width+" "+this.height},ratio:function(){if(!this.icon)return 1;var t=this.icon,e=t.width,i=t.height;return Math.max(e,i)/16},width:function(){return this.childrenWidth||this.icon&&this.icon.width/this.ratio*this.normalizedScale||0},height:function(){return this.childrenHeight||this.icon&&this.icon.height/this.ratio*this.normalizedScale||0},style:function(){return 1!==this.normalizedScale&&{fontSize:this.normalizedScale+"em"}},raw:function(){if(!this.icon||!this.icon.raw)return null;var t=this.icon.raw,e={};return t=t.replace(/\s(?:xml:)?id=["']?([^"')\s]+)/g,function(t,i){var n="fa-"+(s++).toString(16);return e[i]=n,' id="'+n+'"'}),t=t.replace(/#(?:([^'")\s]+)|xpointer\(id\((['"]?)([^')]+)\2\)\))/g,function(t,i,n,o){var s=i||o;return s&&e[s]?"#"+e[s]:t}),t}},mounted:function(){var t=this;if(!this.icon){this.$children.forEach(function(e){e.outerScale=t.normalizedScale});var e=0,i=0;this.$children.forEach(function(t){e=Math.max(e,t.width),i=Math.max(i,t.height)}),this.childrenWidth=e,this.childrenHeight=i,this.$children.forEach(function(t){t.x=(e-t.width)/2,t.y=(i-t.height)/2})}},register:function(t){for(var e in t){var i=t[e];i.paths||(i.paths=[]),i.d&&i.paths.push({d:i.d}),i.polygons||(i.polygons=[]),i.points&&i.polygons.push({points:i.points}),n[e]=i}},icons:n},s=870711,a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("svg",{class:t.klass,style:t.style,attrs:{version:"1.1",role:t.label?"img":"presentation","aria-label":t.label,x:t.x,y:t.y,width:t.width,height:t.height,viewBox:t.box}},[t._t("default",[t.icon&&t.icon.paths?t._l(t.icon.paths,function(e,n){return i("path",t._b({key:"path-"+n},"path",e,!1))}):t._e(),t._v(" "),t.icon&&t.icon.polygons?t._l(t.icon.polygons,function(e,n){return i("polygon",t._b({key:"polygon-"+n},"polygon",e,!1))}):t._e(),t._v("\b\n    "),t.icon&&t.icon.raw?[i("g",{domProps:{innerHTML:t._s(t.raw)}})]:t._e()])],2)},staticRenderFns:[]},r=i("VU/8")(o,a,!1,function(t){i("/AuU")},null,null);e.a=r.exports},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("7+uW"),o={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]},s=i("VU/8")({name:"app"},o,!1,function(t){i("jUnE")},null,null).exports,a=i("/ocq"),r={name:"Home",data:function(){return{room:Math.random().toString(36).substr(2,5).toUpperCase(),url:window.location.origin+"/listen/",roomInUse:!1,accessToken:null,device_id:null,spotify:null,state:null}},created:function(){var t=document.createElement("script");t.setAttribute("src","//sdk.scdn.co/spotify-player.js"),document.head.appendChild(t),window.onSpotifyPlayerAPIReady=this.playerReady},methods:{playerReady:function(){var t=this,e=new window.Spotify.Player({name:"Spotsync",getOAuthToken:function(e){t.$axios.get("/auth/token").then(function(i){t.createSpotifyInstance(i.data),e(i.data)}).catch(function(e){404===e.response.status&&t.$router.push("/login")})}});e.on("initialization_error",function(t){return console.error(t)}),e.on("authentication_error",function(t){return console.error(t)}),e.on("account_error",function(t){return console.error(t)}),e.on("playback_error",function(t){return console.error(t)}),e.on("player_state_changed",function(e){e.timestamp=Date.now(),t.state=e,t.emitState()}),e.on("ready",function(e){console.log("Ready with Device ID",e.device_id),t.device_id=e.device_id,t.switchToPlayer()}),e.connect()},createSpotifyInstance:function(t){this.accessToken=t,this.spotify=this.$axios.create({baseURL:"https://api.spotify.com/v1/",headers:{Authorization:"Bearer "+t}})},setupStream:function(){var t=this;this.$socket.emit("stream",this.room,function(e){t.roomInUse=!e})},switchToPlayer:function(){var t=this,e={device_ids:[this.device_id]};this.spotify.put("/me/player",e).then().catch(function(e){500===e.response.status&&setTimeout(t.switchToPlayer,3e3)})},openSpotify:function(){window.location.replace("spotify:")},playDemo:function(){this.spotify.put("/me/player/play?device_id="+this.device_id,{uris:["spotify:track:4RXpgGM7A4Hg7cFBoH5KyF"]})},copySuccess:function(){this.$message.success("Link copied to clipboard")},emitState:function(){var t=this.state,e={context:t.context,position:t.position+(Date.now()-t.timestamp),track_window:t.track_window};console.log(e),this.$socket.emit("update",e)}},watch:{room:function(){this.setupStream()}},sockets:{connect:function(){this.setupStream()},request:function(){this.emitState()}}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-row",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:!this.device_id,expression:"!this.device_id",modifiers:{fullscreen:!0,lock:!0}}]},[i("el-col",{attrs:{lg:{span:10,offset:7},sm:{span:14,offset:5},xs:{span:22,offset:1}}},[i("h1",{staticClass:"header"},[t._v("Start streaming")]),i("el-card",{staticClass:"card"},[i("div",{attrs:{slot:"header"},slot:"header"},[t._v("Open Spotify")]),i("el-button",{staticClass:"open",attrs:{type:"success"},on:{click:t.openSpotify}},[i("icon",{staticClass:"icon",attrs:{name:"spotify",scale:"1.2"}}),i("span",{staticClass:"text"},[t._v("Open Spotify")])],1)],1),i("el-card",{staticClass:"card"},[i("div",{attrs:{slot:"header"},slot:"header"},[t._v("Start playing a song")]),i("el-button",{attrs:{type:"primary",plain:"plain"},on:{click:t.playDemo}},[i("icon",{staticClass:"icon",attrs:{name:"music",scale:"1.2"}}),i("span",{staticClass:"text"},[t._v("Play a demo song")])],1)],1),i("el-card",{staticClass:"card"},[i("div",{attrs:{slot:"header"},slot:"header"},[i("span",[t._v("Spread the love")]),i("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.url+t.room,expression:"url + room",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.copySuccess,expression:"copySuccess",arg:"success"}],staticClass:"copy",attrs:{type:"text"}},[t._v("Copy to clipboard")])],1),i("span",[t._v("Share this link with friends so they can listen")]),i("el-input",{staticClass:"link",attrs:{id:t.roomInUse?"invalid":void 0},model:{value:t.room,callback:function(e){t.room=e},expression:"room"}},[i("template",{slot:"prepend"},[t._v(t._s(t.url))])],2)],1)],1)],1)},staticRenderFns:[]},l=i("VU/8")(r,c,!1,function(t){i("+I8o"),i("dxme")},"data-v-1b600980",null).exports,u={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"card"},[e("h1",{staticClass:"header"},[this._v("To continue... please login with Spotify")]),e("a",{staticClass:"link",attrs:{href:"/auth/login"}},[e("el-button",{staticClass:"login",attrs:{type:"success"}},[e("icon",{staticClass:"icon",attrs:{name:"spotify",scale:"1.2"}}),e("span",{staticClass:"text"},[this._v("Login with Spotify")])],1)],1)])},staticRenderFns:[]},p=i("VU/8")({name:"Login"},u,!1,function(t){i("6XzT")},"data-v-b4fae5e0",null).exports,h={name:"Listen",data:function(){return{track:{name:"Track Name",uri:"",image:"",artists:"Artist"},device_id:null,spotify:null}},created:function(){var t=document.createElement("script");t.setAttribute("src","//sdk.scdn.co/spotify-player.js"),document.head.appendChild(t),window.onSpotifyPlayerAPIReady=this.playerReady},methods:{playerReady:function(){var t=this,e=new window.Spotify.Player({name:"Spotsync",getOAuthToken:function(e){t.$axios.get("/auth/token").then(function(i){t.createSpotifyInstance(i.data),e(i.data)}).catch(function(e){404===e.response.status&&t.$router.push("/login")})}});e.on("initialization_error",function(t){return console.error(t)}),e.on("authentication_error",function(t){return console.error(t)}),e.on("account_error",function(t){return console.error(t)}),e.on("playback_error",function(t){return console.error(t)}),e.on("ready",function(e){console.log("Ready with Device ID",e.device_id),t.device_id=e.device_id,t.$socket.emit("listen",t.$route.params.room,function(e){e||t.$router.push("/notfound")})}),e.connect()},createSpotifyInstance:function(t){this.accessToken=t,this.spotify=this.$axios.create({baseURL:"https://api.spotify.com/v1/",headers:{Authorization:"Bearer "+t}})}},sockets:{update:function(t){var e=this,i=this.track.uri===t.track_window.current_track.uri;this.track.name=t.track_window.current_track.name,this.track.artists=t.track_window.current_track.artists.map(function(t){return t.name}).join(", "),this.track.image=t.track_window.current_track.album.images[0].url,this.track.uri=t.track_window.current_track.uri,console.log(t),i?this.spotify.put("/me/player/seek?device_id="+this.device_id+"&position_ms="+t.position):this.spotify.put("/me/player/play?device_id="+this.device_id,{uris:[this.track.uri]}).then(function(){e.spotify.put("/me/player/seek?device_id="+e.device_id+"&position_ms="+t.position)})}}},d={render:function(){var t=this.$createElement,e=this._self._c||t;return e("el-row",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:!this.device_id,expression:"!this.device_id",modifiers:{fullscreen:!0,lock:!0}}]},[e("el-col",{staticClass:"main",attrs:{md:{span:10,offset:7},sm:{span:12,offset:6},xs:{span:22,offset:1}}},[e("h1",{staticClass:"header"},[this._v("Currently listening to")]),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:6}},[e("img",{staticClass:"img",attrs:{src:this.track.image,width:"100%"}})]),e("el-col",{attrs:{span:18}},[e("div",{staticClass:"name"},[this._v(this._s(this.track.name))]),e("div",{staticClass:"artist"},[this._v(this._s(this.track.artists))])])],1)],1)],1)},staticRenderFns:[]},f=i("VU/8")(h,d,!1,function(t){i("bo8y")},"data-v-3b2d198c",null).exports,m={render:function(){var t=this.$createElement,e=this._self._c||t;return e("el-row",[e("el-col",{staticClass:"main",attrs:{md:{span:10,offset:7},sm:{span:12,offset:6},xs:{span:22,offset:1}}},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:6}},[e("icon",{staticClass:"icon-stack",attrs:{label:"No Music",scale:"4"}},[e("icon",{staticClass:"icon-headphones",attrs:{name:"volume-up"}}),e("icon",{staticClass:"icon-ban",attrs:{name:"ban",scale:"2"}})],1)],1),e("el-col",{attrs:{span:18}},[e("h1",{staticClass:"title"},[this._v("Can't hear anything?")]),e("p",{staticClass:"subtitle"},[this._v("We think you may have entered the link incorrectly...")])])],1)],1)],1)},staticRenderFns:[]},v=i("VU/8")({name:"NotFound"},m,!1,function(t){i("bLcV")},"data-v-184e1114",null).exports;n.default.use(a.a);var y=new a.a({mode:"history",routes:[{path:"/",name:"Home",component:l},{path:"/login",name:"Login",component:p},{path:"/listen/:room",name:"Listen",component:f},{path:"/notfound",name:"NotFound",component:v},{path:"*",redirect:"/"}]}),_=i("zL8q"),g=i.n(_),w=(i("tvR6"),i("D4uH")),k=(i("D/PP"),i("wvfG")),b=i.n(k),S=i("hMcO"),x=i.n(S),C=i("mtWM"),$=i.n(C);n.default.use(g.a),n.default.component("icon",w.a),n.default.use(b.a),n.default.use(x.a,"/"),Object.defineProperty(n.default.prototype,"$axios",{value:$.a}),n.default.config.productionTip=!1,new n.default({el:"#app",router:y,template:"<App/>",components:{App:s}})},bLcV:function(t,e){},bo8y:function(t,e){},dxme:function(t,e){},jUnE:function(t,e){},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.3908a2a1f65b62c86300.js.map