var spotify;interval=null,$(document).ready(function(){$(".fa-play").click(function(){if($(".fa-play").hasClass("fa-pause")&&($(".fa-play").removeClass("fa-pause"),player.mute=!0),$(".fa-play").hasClass("fa-microphone")){if($(".fa-microphone").hasClass("bounce"))$(".fa-microphone").removeClass("bounce infinite");else if($(".fa-stack").hasClass("text-danger"))return clearInterval(interval),$(".fa-stack").removeClass("text-danger"),$(".fa-microphone").addClass("fa-microphone-slash"),void(player.mute=!0);$(".fa-microphone-slash").removeClass("fa-microphone-slash"),$(".fa-stack").addClass("text-danger"),$(".fa-stack").fadeOut().delay(100).fadeIn(),player.mute=!1,player.play(),clearInterval(interval),interval=setInterval(function(){$(".fa-stack").fadeOut().delay(100).fadeIn()},3e3)}else $(".fa-play").addClass("fa-pause"),player.mute=!1}),$("#csrf").keyup(function(){var a=$("#csrf").val();Spotify.start(a,function(e,s,l){e?(window.localStorage.setItem("csrf",a),document.location.reload(!0)):$("#csrf").parent().parent().addClass("has-error")})})});
function Timer(){var t,e;this.start=function(n){n&&"number"==typeof n?t=n:(e=new Date,t=e.getTime())},this.stop=function(){return e=new Date,e.getTime()-t}}var difference=function(t,e){return Math.abs(t-e)};
var player={format:function(i){return Math.floor(i/60)+":"+"0".substring(0,2-JSON.stringify(i%60).length)+i%60},play:function(i,t){if(!player.mute)if("function"==typeof i&&(t=i),$(".fa-stack").hasClass("text-danger"))spotify.status(1).done(function(i){var t=new Date;i.time=t.getTime(),socket.emit("play",i),setTimeout(function(){player.play()},3e3)});else{var e=new Timer;e.start(i.time),spotify.status(1).done(function(n){if(delay=e.stop()/1e3,console.log(1e3*difference(i.playing_position+delay,n.playing_position)%1e3),n.playing&&difference(i.playing_position+delay,n.playing_position)>.1)spotify.togglePause().done(function(n){if(i.playing){var o=i.track.track_resource.uri+player.format(Math.round(i.playing_position+e.stop()/1e3));spotify.play(o,function(i){t(i)})}});else if(i.playing&&difference(i.playing_position+delay,n.playing_position)>.1){var o=i.track.track_resource.uri+"#"+player.format(Math.round(i.playing_position+e.stop()/1e3));spotify.play(o,function(i){t(i)})}})}},mute:!0};
var socket=io.connect("/");socket.emit("room",window.location.pathname.substr(1)),socket.on("first",function(){$(".fa-play").addClass("fa-microphone animated infinite bounce")}),socket.on("play",function(o){player.play(o,function(){console.log("yay")})});
var spotify;$(document).ready(function(){$(".csrf").fadeIn(),null!==window.localStorage.getItem("csrf")&&Spotify.start(window.localStorage.getItem("csrf"),function(t,e,f){t&&(spotify=e,$(".csrf").fadeOut(),setTimeout(function(){$(".fa-stack").hide().fadeIn(),$(".csrf").hide()},400))})});
//# sourceMappingURL=scripts.min.js.map
