{"version":3,"sources":["js/button.js","js/functions.js","js/player.js","js/socket.js","js/spotify.js"],"names":["spotify","interval","$","document","ready","click","hasClass","removeClass","player","mute","clearInterval","addClass","fadeOut","delay","fadeIn","play","setInterval","keyup","value","val","Spotify","start","ok","instance","msg","window","localStorage","setItem","location","reload","parent","Timer","begin","d","this","num","Date","getTime","stop","difference","a","b","Math","abs","format","floor","substring","JSON","stringify","length","track","cb","status","done","date","time","socket","emit","setTimeout","timer","console","log","playing_position","playing","togglePause","uri","track_resource","round","io","connect","pathname","substr","on","getItem","hide"],"mappings":"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","file":"scripts.min.js","sourcesContent":["var spotify;\ninterval = null;\n$(document).ready(function() {\n  $('.fa-play').click(function() {\n    if ($('.fa-play').hasClass('fa-pause')) {\n      $('.fa-play').removeClass('fa-pause');\n      player.mute = true;\n    }\n\n    if ($('.fa-play').hasClass('fa-microphone')) {\n      if ($('.fa-microphone').hasClass('bounce')) {\n        $('.fa-microphone').removeClass('bounce infinite');\n      } else if ($('.fa-stack').hasClass('text-danger')) {\n        clearInterval(interval);\n        $('.fa-stack').removeClass('text-danger');\n        $('.fa-microphone').addClass('fa-microphone-slash');\n        player.mute = true;\n        return;\n      }\n\n      $('.fa-microphone-slash').removeClass('fa-microphone-slash');\n      $('.fa-stack').addClass('text-danger');\n      $('.fa-stack').fadeOut().delay(100).fadeIn();\n      player.mute = false;\n      player.play();\n\n      clearInterval(interval);\n      interval = setInterval(function() {\n        $('.fa-stack').fadeOut().delay(100).fadeIn();\n      }, 3000);\n    } else {\n      $('.fa-play').addClass('fa-pause');\n      player.mute = false;\n    }\n  });\n\n  $('#csrf').keyup(function() {\n    var value = $('#csrf').val();\n    Spotify.start(value, function(ok, instance, msg) {\n      if (ok) {\n        window.localStorage.setItem('csrf', value);\n        document.location.reload(true);\n      } else {\n        $('#csrf').parent().parent().addClass('has-error');\n      }\n    });\n  });\n});\n","function Timer() {\n  var begin, d;\n\n  this.start = function(num) {\n    if (num && typeof num === 'number') {\n      begin = num;\n    } else {\n      d = new Date();\n      begin = d.getTime();\n    }\n  };\n\n  this.stop = function() {\n    d = new Date();\n    return d.getTime() - begin;\n  };\n}\n\nvar difference = function(a, b) {\n  return Math.abs(a - b);\n};\n","var player = {\n  format: function(num) {\n    return Math.floor(num / 60) + ':' + '0'.substring(0, 2 - JSON.stringify(num % 60).length) + num % 60;\n  },\n  play: function(track, cb) {\n    if (!player.mute) {\n      if (typeof track === 'function') {\n        cb = track;\n      }\n\n      if ($('.fa-stack').hasClass('text-danger')) {\n        spotify.status(1).done(function(d) {\n          var date = new Date();\n          d.time = date.getTime();\n    \t\t\tsocket.emit('play', d);\n          setTimeout(function() {\n            player.play();\n          }, 3000);\n    \t\t});\n      } else {\n        var timer = new Timer();\n        timer.start(track.time);\n        spotify.status(1).done(function(d) {\n          delay = timer.stop() / 1000;\n          console.log((difference(track.playing_position + delay, d.playing_position) * 1000) % 1000);\n          if (d.playing  && difference(track.playing_position + delay, d.playing_position) > 0.1) {\n            spotify.togglePause().done(function(d) {\n              if (track.playing) {\n                var uri = track.track.track_resource.uri + player.format(Math.round(track.playing_position + (timer.stop() / 1000)));\n                spotify.play(uri, function(d) {\n                  cb(d);\n                });\n              }\n            });\n          } else {\n            if (track.playing && difference(track.playing_position + delay, d.playing_position) > 0.1) {\n              var uri = track.track.track_resource.uri + '#' + player.format(Math.round(track.playing_position + (timer.stop() / 1000)));\n              spotify.play(uri, function(d) {\n                cb(d);\n              });\n            }\n          }\n        });\n      }\n    }\n  },\n  mute: true\n};\n","var socket = io.connect('/');\n\nsocket.emit('room', window.location.pathname.substr(1));\n\nsocket.on('first', function() {\n  $('.fa-play').addClass('fa-microphone animated infinite bounce');\n});\n\nsocket.on('play', function(d) {\n  player.play(d, function() {\n    console.log('yay');\n  });\n});\n","var spotify;\n$(document).ready(function() {\n  $('.csrf').fadeIn();\n  if (window.localStorage.getItem('csrf') !== null) {\n    Spotify.start(window.localStorage.getItem('csrf'), function(ok, instance, msg) {\n      if (ok) {\n        spotify = instance;\n        $('.csrf').fadeOut();\n        setTimeout(function() {\n          $('.fa-stack').hide().fadeIn();\n          $('.csrf').hide();\n        }, 400);\n      }\n    });\n  }\n});\n"],"sourceRoot":"/source/"}